<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>저녁을 부탁해</title>
    <!-- style -->
    <link rel="stylesheet" href="./css/common.css">
    <!-- js -->
    <script src="./src/chat.js" defer type="module"></script>
    <!-- tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body>
    <div class="header">
      <h1><a href="index.html">저녁메뉴 추천 봇</a></h1>
      <div class="header-click">
        <a href="./answer_list.html">채팅내역</a>
        <a href="./register.html">회원가입</a>
        <a href="./login.html">로그인</a>
      </div>
    </div>
    <div class="flex items-center">
      <div class="m-0 flex-1">
        <h2 class="text-3xl mt-5 ml-7">재료 입력</h2>
        <form
          method="post"
          class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 w-4/5"
          id="ingredientForm"
        >
          <div>
            <label
              for="ingredient"
              class="block text-gray-700 text-sm font-bold mb-2 text-xl"
              >재료를 적으세요</label
            >
            <input
              type="text"
              id="ingredient"
              placeholder="ex) 돼지고기, 파 등등"
              autofocus
              class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline mb-4"
            />
          </div>
          <div>
            <p class="block text-gray-700 text-sm font-bold mb-4 text-xl">종류</p>
            <input type="radio" name="type" id="type1" value="한식" checked />
            <label for="type1" class="text-xl">한식</label>
            <input type="radio" name="type" id="type2" value="일식요리" />
            <label for="type2" class="text-xl">일식</label>
            <input type="radio" name="type" id="type3" value="중식" />
            <label for="type3" class="text-xl">중식</label>
            <input type="radio" name="type" id="type4" value="양식요리" />
            <label for="type4" class="text-xl">양식</label>
          </div>
          <div>
            <label
              for="num"
              class="block text-gray-700 text-sm font-bold mb-2 mt-4 text-xl"
              >추천받을 수</label
            >
            <select
              id="num"
              class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline"
            >
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3" selected>3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>
          </div>
          <button
            type="submit"
            class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full mt-4 mb-4"
          >
            전송
          </button>
        </form>
      </div>
      <div id="content" class="flex w-1/2 h-full px-8 pt-6 pb-8 mb-4"></div>
    </div>
    <div id="sub_title" class="flex">
      <div class="w-1/2">
        <p class="block text-gray-700 text-sm font-bold mb-4 text-xl">
          메뉴 추천
        </p>
      </div>
    </div>
    <ul class="flex flex-wrap"></ul>

    <script>
      // 로그인 여부를 확인하는 함수
      function isLoggedIn() {
        const token = getCookie("token");
        return token !== null;
      }

      // 로그인이 필요한 경우 메시지를 출력하고 로그인 페이지로 이동하는 함수
      function showLoginMessageAndRedirect() {
        alert("로그인이 필요합니다.");
        window.location.href = "./login.html";
      }

      const $form = document.getElementById("ingredientForm");
      const $input = document.getElementById("ingredient");

      $form.addEventListener("submit", (e) => {
        if (!isLoggedIn()) {
          // 로그인이 필요한 경우 메시지를 출력하고 로그인 페이지로 이동
          showLoginMessageAndRedirect();
          e.preventDefault(); // 기본 동작 막기
          return;
        }

        // 이하 기존의 submit 이벤트 핸들러 코드
        // ...

        e.preventDefault(); // submit 이벤트의 기본 동작 막기
      });

      // CSRF 토큰을 쿠키에서 가져오는 함수
      function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== "") {
          const cookies = document.cookie.split(";");
          for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === name + "=") {
              cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
              break;
            }
          }
        }
        return cookieValue;
      }
    </script>
  </body>
</html>
